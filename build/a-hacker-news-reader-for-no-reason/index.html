<!doctype html> <html> <head> <meta charset=utf-8> <meta http-equiv=x-ua-compatible content="ie=edge"> <meta name=viewport content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta name=author content="Michael Elliott"/> <meta name=description content="elliotec | A software blog by Mike Elliott"/> <meta name="msvalidate.01" content=7B2214FD9C6E6C4B63E8D61D4C7B5DF7 /> <meta name=google-site-verification content=MFyo9_KaHWW1rrf6ct225HChB1FOm1Cf9o6Y60qyYtU /> <link rel=alternate type="application/atom+xml" title=elliotec href="/feed.xml"/> <title>elliotec | A Hacker News Reader For No Reason - In 5K of Vanilla JS, HTML, & CSS</title> <style>/*! sanitize.css v3.3.0 | CC0 1.0 Public Domain | github.com/10up/sanitize.css */button,input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button}button,hr{overflow:visible}h1,h2{margin:20px 0 16px}pre,textarea{overflow:auto}a,a:focus,a:hover{color:#2196f3}a:focus,a:hover,abbr[title],u{text-decoration:underline}img,select[multiple]{height:auto}hr,legend{width:100%}details,hr,legend,main,pre,summary,textarea{display:block}footer,img,textarea{max-width:100%}*,code{margin:0;padding:0}dl,hr,table{margin-bottom:16px}caption,fieldset,legend{padding:8px 0}legend,ol,textarea,tr,ul{margin-bottom:8px}pre,td,th{padding:16px}::after,::before,td,th{vertical-align:inherit}tfoot tr,thead th{text-align:left}abbr[title]{text-decoration:underline dotted}audio:not([controls]){display:none}b,strong{font-weight:bolder}button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}button:-moz-focusring,input:-moz-focusring{outline:ButtonText dotted 1px}button,select{text-transform:none}html{-ms-overflow-style:-ms-autohiding-scrollbar;overflow-y:scroll;-webkit-text-size-adjust:100%}input{-webkit-border-radius:0}input[type=number]{width:auto}input[type=search]{-webkit-appearance:textfield}input[type=search]::-webkit-search-cancel-button,input[type=search]::-webkit-search-decoration{-webkit-appearance:none}progress{display:inline-block}svg:not(:root){overflow:hidden}[hidden],template{display:none}*,::after,::before{box-sizing:inherit;border-style:solid;border-width:0}footer,hr{border-top:1px solid rgba(0,0,0,0.12)}*{font-size:inherit;line-height:inherit;background-repeat:no-repeat}::after,::before{text-decoration:inherit}button,input,select,textarea{font-family:inherit;font-style:inherit;font-weight:inherit;background-color:transparent;color:inherit}[tabindex],a,area,button,input,label,select,textarea{-ms-touch-action:manipulation;touch-action:manipulation}select::-ms-expand{display:none}select::-ms-value{color:currentColor}svg{fill:currentColor}[aria-busy=true]{cursor:progress}[aria-controls]{cursor:pointer}[aria-disabled]{cursor:default}[hidden][aria-hidden=false]{clip:rect(0 0 0 0);display:inherit;position:absolute}[hidden][aria-hidden=false]:focus{clip:auto}:root{background-color:#fff;box-sizing:border-box;color:#000;cursor:default;font:66.66667% sans-serif}h1,h2,h3{font-weight:500}a{text-decoration:none}audio,canvas,iframe,img,svg,video{vertical-align:middle}code,img,ol,ul{vertical-align:baseline}[type=button],[type=email],[type=month],[type=password],[type=tel],[type=text],[type=time],[type=url],[type=week],[type=reset],[type=submit],[type=number],[type=search],[type=date],[type=datetime],[type=datetime-local],button,select,textarea{min-height:1.5em}code,kbd,pre,samp{font-family:monospace,monospace}nav ol,nav ul{list-style:none}small{font-size:75%;color:rgba(0,0,0,0.54);vertical-align:bottom}::-moz-selection{background-color:#b3d4fc;color:#fff;text-shadow:none}::selection{background-color:#b3d4fc;color:#fff;text-shadow:none}article,aside,details,footer,header,main,section,summary{margin:0 auto 16px;width:100%}main{margin:0 auto;max-width:768px;padding:0 16px 16px}footer{clear:both;display:inline-block;float:left;padding:16px 0;text-align:center}footer p{margin-bottom:0}@media screen and (max-width: 400px){article,aside,section{clear:both;display:block;max-width:100%}}body{color:rgba(0,0,0,0.8);font-family:"Helvetica Neue",Helvetica,"Lucida Grande",sans-serif;font-size:16px;line-height:1.4}p{margin:0 0 16px}h1,h2,h3,h4,h5,h6{color:inherit;font-family:inherit;line-height:inherit}h1{border-bottom:1px solid rgba(0,0,0,0.12);font-size:36px}h2{font-size:30px}h3{font-size:24px;margin:16px 0 4px}h4,h5,h6{font-weight:600;margin:16px 0 4px}h4{font-size:18px}h5{font-size:16px}h6{color:rgba(0,0,0,0.54);font-size:14px}code,pre{font-family:Menlo,Monaco,Consolas,"Courier New",monospace;font-size:16px;color:rgba(0,0,0,0.8)}pre{background:#efefef;margin:16px 0;white-space:pre-wrap}code{line-height:inherit;word-break:break-all;word-wrap:break-word}blockquote,figcaption{font-family:Georgia,Times,"Times New Roman",serif}sub,sup{font-size:14px}dd{margin-left:40px}ol,ul{padding-left:40px}blockquote{border-left:2px solid #2196f3;font-style:italic;margin:16px 0;padding-left:16px}s{text-decoration:line-through}sup{vertical-align:super}sub{vertical-align:sub}mark{background:#ffeb3b}input[type=email],input[type=month],input[type=password],input[type=tel],input[type=text],input[type=time],input[type=url],input[type=week],input[type=number],input[type=search],input[type=date],input[type=datetime],input[type=datetime-local],select{background:#fff;border:1px solid rgba(0,0,0,0.12);border-radius:4px;color:rgba(0,0,0,0.8);display:inline-block;padding:4px;vertical-align:middle}input[type=color]{background:#fff;border:1px solid rgba(0,0,0,0.12);border-radius:4px;display:inline-block;vertical-align:middle}input:not([type]){-webkit-appearance:none;background-clip:padding-box;border:1px solid rgba(0,0,0,0.12);border-radius:4px;display:inline-block;padding:8px;text-align:left}select,textarea{border:1px solid rgba(0,0,0,0.12)}input[type=email]:focus,input[type=month]:focus,input[type=password]:focus,input[type=tel]:focus,input[type=text]:focus,input[type=time]:focus,input[type=url]:focus,input[type=week]:focus,input[type=color]:focus,input[type=number]:focus,input[type=search]:focus,input[type=date]:focus,input[type=datetime]:focus,input[type=datetime-local]:focus,select:focus,textarea:focus{border-color:#2196f3}input:not([type]):focus{border-color:#2196f3}input[type=file]:focus,input[type=radio]:focus,input[type=checkbox]:focus{outline:thin 1px}input[type=email][disabled],input[type=month][disabled],input[type=password][disabled],input[type=tel][disabled],input[type=text][disabled],input[type=time][disabled],input[type=url][disabled],input[type=week][disabled],input[type=color][disabled],input[type=number][disabled],input[type=search][disabled],input[type=date][disabled],input[type=datetime][disabled],input[type=datetime-local][disabled],select[disabled],textarea[disabled]{background-color:rgba(0,0,0,0.12);color:rgba(0,0,0,0.54);cursor:not-allowed}input:not([type])[disabled]{background-color:rgba(0,0,0,0.12);color:rgba(0,0,0,0.54);cursor:not-allowed}input[readonly],select[readonly],textarea[readonly]{border-color:rgba(0,0,0,0.12);color:rgba(0,0,0,0.54)}input:focus:invalid,select:focus:invalid,textarea:focus:invalid{border-color:#ea1c0d;color:#f44336}input[type=file]:focus:invalid:focus,input[type=radio]:focus:invalid:focus,input[type=checkbox]:focus:invalid:focus{outline-color:#f44336}select{-moz-appearance:none;-webkit-appearance:menulist-button;vertical-align:sub}label{line-height:2}fieldset{border:0;margin:0}legend{border-bottom:1px solid rgba(0,0,0,0.12);color:rgba(0,0,0,0.8)}textarea{resize:vertical;background:#fff;border-radius:4px;padding:8px;vertical-align:middle}button,input[type=reset],input[type=submit]{background:#2196f3;border:1px solid rgba(0,0,0,0.12);border-radius:4px;color:#fff;cursor:pointer;display:inline-block;margin:0;padding:8px 16px;text-align:center;vertical-align:middle;white-space:nowrap}button::-moz-focus-inner,input[type=reset]::-moz-focus-inner,input[type=submit]::-moz-focus-inner{padding:0}button:hover,input[type=reset]:hover,input[type=submit]:hover{background:#0c7cd5;border-color:1px solid rgba(0,0,0,0.54)}button:active,input[type=reset]:active,input[type=submit]:active{background:#0c7cd5;border-color:1px solid rgba(0,0,0,0.54);box-shadow:inset 0 0 4px 0 rgba(0,0,0,0.2);outline-offset:-2px}button:focus,input[type=reset]:focus,input[type=submit]:focus{background:#0c7cd5;border-color:1px solid rgba(0,0,0,0.54);box-shadow:inset 0 0 4px 0 rgba(0,0,0,0.2);outline:0}button:disabled,input[type=submit]:disabled{background:rgba(0,0,0,0.12);color:rgba(0,0,0,0.38);cursor:not-allowed}table{border-collapse:collapse;border-spacing:0;border-top:1px solid rgba(0,0,0,0.12)}thead th{border:0;border-bottom:2px solid rgba(0,0,0,0.12)}td,th{border-bottom:1px solid rgba(0,0,0,0.12)}tfoot td{color:rgba(0,0,0,0.54);font-size:8px;font-style:italic;padding:16px 4px}
</style> <style>.highlight table td{padding:5px}.highlight table pre{margin:0}.highlight .c,.highlight .cd{color:#5e5d83;font-style:italic}.highlight .cm{color:#5e5d83;font-style:italic}.highlight .c1{color:#5e5d83;font-style:italic}.highlight .cp{color:#465457;font-weight:bold}.highlight .cs{color:#465457;font-weight:bold;font-style:italic}.highlight .err{color:#f8f8f2;background-color:#403d3d}.highlight .gi{color:#a6e22e}.highlight .gd{color:#f92672}.highlight .ge{color:#1b1d1e;font-style:italic}.highlight .gr{color:#f92672}.highlight .gt{color:#f92672}.highlight .gh{color:#403d3d}.highlight .go{color:#403d3d}.highlight .gp{color:#66d9ef}.highlight .gs{font-weight:bold}.highlight .gu{color:#465457}.highlight .k,.highlight .kv{color:#66d9ef;font-weight:bold}.highlight .kc{color:#66d9ef;font-weight:bold}.highlight .kd{color:#66d9ef;font-weight:bold}.highlight .kp{color:#66d9ef;font-weight:bold}.highlight .kr{color:#66d9ef;font-weight:bold}.highlight .kt{color:#66d9ef;font-weight:bold}.highlight .kn{color:#f92672;font-weight:bold}.highlight .ow{color:#f92672;font-weight:bold}.highlight .o{color:#f92672;font-weight:bold}.highlight .mf{color:#af87ff}.highlight .mh{color:#af87ff}.highlight .il{color:#af87ff}.highlight .mi{color:#af87ff}.highlight .mo{color:#af87ff}.highlight .m,.highlight .mb,.highlight .mx{color:#af87ff}.highlight .se{color:#af87ff}.highlight .sb{color:#d7d787}.highlight .sc{color:#d7d787}.highlight .sd{color:#d7d787}.highlight .s2{color:#d7d787}.highlight .sh{color:#d7d787}.highlight .si{color:#d7d787}.highlight .sx{color:#d7d787}.highlight .sr{color:#d7d787}.highlight .s1{color:#d7d787}.highlight .ss{color:#d7d787}.highlight .s{color:#d7d787}.highlight .na{color:#a6e22e}.highlight .nc{color:#a6e22e;font-weight:bold}.highlight .nd{color:#a6e22e;font-weight:bold}.highlight .ne{color:#a6e22e;font-weight:bold}.highlight .nf{color:#a6e22e;font-weight:bold}.highlight .no{color:#66d9ef}.highlight .bp{color:#f8f8f2}.highlight .nb{color:#f8f8f2}.highlight .ni{color:#f8f8f2}.highlight .nn{color:#f8f8f2}.highlight .vc{color:#f8f8f2}.highlight .vg{color:#f8f8f2}.highlight .vi{color:#f8f8f2}.highlight .nv{color:#f8f8f2}.highlight .w{color:#f8f8f2}.highlight .nl{color:#f8f8f2;font-weight:bold}.highlight .nt{color:#f92672}.highlight{color:#f8f8f2;background-color:#1b1d1e}</style> <style>body{color:#333;font-family:"Helvetica Neue", "Helvetica", "Oxygen", "Ubuntu", sans-serif}h1,h2{line-height:1.25}header{height:40px;background-color:#333;text-align:center;width:100%;z-index:999;position:fixed;top:0;line-height:1.5}header a{color:#27ae60;display:inline-block;font-size:22px;padding-top:4px;text-decoration:none}header a:hover{text-decoration:none;color:#27ae60}main{max-width:696px}.copyright{text-align:center;margin:24px;font-size:10px}.home{border-bottom:solid 1px #DDD;margin-top:64px;text-align:center;padding-bottom:32px}.home .intro{font-size:18px}.home h1{border:none;font-size:42px}.home .contact{padding:8px;display:flex;flex-direction:row;justify-content:center;font-size:16px}@media (max-width: 500px){.home .contact{flex-wrap:wrap}.home .contact .contact-link{width:50%}}.home .contact-link{line-height:1;padding:8px;margin:8px;color:#2ecc71;border-radius:2px;border:1px solid #2ecc71}.home .contact-link:hover,.home .contact-link:focus{border-color:#27ae60;color:#1e8449;text-decoration:none}.posts{text-align:center;margin-bottom:32px}.posts h2{padding:16px}.posts ul{padding:0}.posts ul li{list-style-type:none;font-size:18px}.posts ul li a{color:#1e8449}.posts ul li a:hover{color:#2ecc71;text-decoration:none}.posts ul p{font-size:12px;font-style:italic}.post{margin-top:48px;margin-bottom:32px;line-height:1.7}.post h1{padding:8px 0}.post a{color:#27ae60}.post a:hover{color:#2ecc71;text-decoration:none}.highlight>pre{word-wrap:normal;overflow-x:scroll}.post pre code{overflow-x:scroll;white-space:pre;padding:8px;border-radius:2px;font-family:"Lucida Console", Monaco, monospace, "AdamicBee";background-color:#1b1d1e;color:#ddd}code{background-color:#465457;color:#d7d787;font-size:14px;padding:2px 4px;margin:2px;white-space:nowrap}.post blockquote{border-left:2px solid #ddd;color:#595959}.post iframe{margin-top:24px;width:100%;height:500px}.post article{font-size:18px}.post article .date{font-size:14px;display:block;margin:8px 0}.rss{text-align:center;font-size:12px}.rss a{color:#27ae60}.rss a:hover{color:#2ecc71}
</style> </head> <body> <header> <a href="/">{ elliotec }</a> </header> <main class=post> <article> <h1>A Hacker News Reader For No Reason - In 5K of Vanilla JS, HTML, & CSS</h1> <em class=date>November 18, 2017</em> <p>The title is only half true.</p> <p>The other night I was thinking about how my experience being fully entrenched in React and the modern JavaScript ecosystem lately might have influenced how I&rsquo;d write an app by hand in vanilla HTML, CSS, and JS with no libraries or anything.</p> <p>Within the same hour I was looking at <a href="https://news.ycombinator.com/">Hacker News</a> and some of it&rsquo;s reader clients, noting how they all kind of sucked as far as UX (including HN itself - only recently adding comment collapsing and mobile support), and discovered <a href="https://github.com/HackerNews/API">the Hacker News API</a>.</p> <p>Clearly this presented an opportunity to build my own HN reader in the lightest way I could - fully client side, no libraries, totally vanilla.</p> <p>So I did it in 2 files, 99 lines of JavaScript, and 99 lines of HTML/CSS.</p> <p>The files will automatically go through my build script since they&rsquo;re hosted on this site (<a href="https://elliotec.com/how-to-get-100-google-page-speed-score/">as explained here</a>). The JS is only 4.4 KB in the first place, but minifying it and gzipping it brought it down to 1.5 KB which is pretty significant. The HTML file is 3.5 KB minified and gzipped.</p> <p>I&rsquo;ll save you the arithmetic, that&rsquo;s a grand total of <em>5 KB</em> on the initial load.</p> <p><a href="/hn-no-reason/" target=_blank> <h2>Go to A Hacker News Reader For No Reason!</h2> <img src="../images/hn-no-reason-5c509607.png" alt='HN App Image'/> </a></p> <h3>Features</h3> <ul> <li>Gets the top 30 stories in order with their points, just like the front page of HN.</li> <li>If the story has a URL, the title will take you to a new tab with the URL, otherwise it will toggle the text content of the story (like Ask, Show, Jobs, etc.).</li> <li>If the story has comments, there&rsquo;s a link to toggle the comments.</li> <li>Each comment and their children are collapsible.</li> <li>There&rsquo;s a link to the original story on HN, and to the user that submitted the story or comments.</li> <li>Looks decent on all devices.</li> <li>Super tiny and pretty fast.</li> </ul> <h3>Limitations</h3> <ul> <li>Since I&rsquo;m using modern ECMAScript features, only more modern browsers will support it, but most of my audience is probably fine with that.</li> <li>It only shows the top stories - no support for New, Ask, Jobs, etc. unless they&rsquo;re on the front page. This is not a limitation to me personally since I spend 99% of my HN time just on the front page.</li> <li>No login, upvote/downvote, or posting functionality. Unfortunately the HN API doesn&rsquo;t support this yet, but if/when it does, maybe I&rsquo;ll try to get all that in with another 99 lines :D</li> <li>I&rsquo;m not a designer. This was styled with my typical aesthetic of a minimal dark theme with green all over. Probably not everyone&rsquo;s favorite but certainly mine, and it&rsquo;s mine, so whatever.</li> </ul> <h3>The Code</h3> <p>I wrote the styles in a <code>&lt;style&gt;</code> tag in <code>index.html</code>. Since one of the goals I had with this was to keep it super small and light, I characteristically set an arbitrary limit of lines for myself at a number I figured seemed reasonable to finish it within.</p> <p>I fudged some of my usual code style guidelines and there were a few times I disrespected the 80-character line rule I prefer to abide by in order to hit the 99 line mark in both files, but nothing too crazy and I&rsquo;m not crossing any hard bad-practice lines.</p> <p><a href="https://github.com/elliotec/hn-no-reason">You can check out the repo here</a> - but since it&rsquo;s only 99 lines, I&rsquo;ve posted the contents of JS file below.</p> <p>Note the use of several ES6+ features and the resemblance to React and JSX with the templating. Of course, there&rsquo;s no fancy Virtual DOM or anything here and it&rsquo;s simply manipulating the DOM as needed. I&rsquo;m using functional and immutable patterns where applicable, in the parlance of our time.</p> <div class=highlight><pre class="highlight javascript"><code>
<span class="kd">const</span> <span class="nx">hnBaseUrl</span> <span class="o">=</span> <span class="s1">'https://hacker-news.firebaseio.com/v0'</span>
<span class="kd">const</span> <span class="nx">state</span> <span class="o">=</span> <span class="p">{}</span>
<span class="kd">function</span> <span class="nx">fetchTopStories</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">topStoriesUrl</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">hnBaseUrl</span><span class="p">}</span><span class="s2">/topstories.json`</span>
  <span class="k">return</span> <span class="nx">fetch</span><span class="p">(</span><span class="nx">topStoriesUrl</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span> <span class="o">=&gt;</span> <span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">())</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">data</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">fetchStories</span><span class="p">(</span><span class="nx">data</span><span class="p">))</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nx">fetchStories</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">topStories</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">29</span><span class="p">)</span>
  <span class="kd">const</span> <span class="nx">storyIds</span> <span class="o">=</span> <span class="nx">topStories</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">storyId</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">storyUrl</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">hnBaseUrl</span><span class="p">}</span><span class="s2">/item/</span><span class="p">${</span><span class="nx">storyId</span><span class="p">}</span><span class="s2">.json`</span>
    <span class="k">return</span> <span class="nx">fetch</span><span class="p">(</span><span class="nx">storyUrl</span><span class="p">).</span><span class="nx">then</span><span class="p">((</span><span class="nx">response</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">())</span>
      <span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">story</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">story</span><span class="p">)</span>
  <span class="p">})</span>
  <span class="k">return</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">all</span><span class="p">(</span><span class="nx">storyIds</span><span class="p">).</span><span class="nx">then</span><span class="p">((</span><span class="nx">stories</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">state</span><span class="p">.</span><span class="nx">stories</span> <span class="o">=</span> <span class="nx">stories</span>
    <span class="nx">renderStories</span><span class="p">(</span><span class="nx">stories</span><span class="p">)</span>
  <span class="p">})</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nx">renderStories</span><span class="p">(</span><span class="nx">stories</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">stories</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">story</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">userUrl</span> <span class="o">=</span> <span class="s2">`https://news.ycombinator.com/user?id=</span><span class="p">${</span><span class="nx">story</span><span class="p">.</span><span class="nx">by</span><span class="p">}</span><span class="s2">`</span>
    <span class="kd">const</span> <span class="nx">storyItemUrl</span> <span class="o">=</span> <span class="s2">`https://news.ycombinator.com/item?id=</span><span class="p">${</span><span class="nx">story</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="s2">`</span>
    <span class="kd">const</span> <span class="nx">html</span> <span class="o">=</span> <span class="s2">`
      &lt;div class='story' id='</span><span class="p">${</span><span class="nx">story</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="s2">'&gt;
        &lt;h3 class='title'&gt;
          </span><span class="p">${</span><span class="nx">story</span><span class="p">.</span><span class="nx">url</span> <span class="p">?</span> <span class="s2">`&lt;a href='</span><span class="p">${</span><span class="nx">story</span><span class="p">.</span><span class="nx">url</span><span class="p">}</span><span class="s2">' target='_blank'&gt;</span><span class="p">${</span><span class="nx">story</span><span class="p">.</span><span class="nx">title</span><span class="p">}</span><span class="s2">&lt;/a&gt;`</span>
            <span class="p">:</span> <span class="s2">`&lt;a href='javascript:void(0)' onclick="toggleStoryText('</span><span class="p">${</span><span class="nx">story</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="s2">')" &gt;</span><span class="p">${</span><span class="nx">story</span><span class="p">.</span><span class="nx">title</span><span class="p">}</span><span class="s2">&lt;/a&gt;`</span><span class="p">}</span><span class="s2">
        &lt;/h3&gt;
        &lt;span class='score'&gt; </span><span class="p">${</span><span class="nx">story</span><span class="p">.</span><span class="nx">score</span><span class="p">}</span><span class="s2"> &lt;/span&gt; points by
        &lt;a href='</span><span class="p">${</span><span class="nx">userUrl</span><span class="p">}</span><span class="s2">' target='_blank' class='story-by'&gt; </span><span class="p">${</span><span class="nx">story</span><span class="p">.</span><span class="nx">by</span><span class="p">}</span><span class="s2">&lt;/a&gt;
        &lt;div class='toggle-view'&gt;
          </span><span class="p">${</span><span class="nx">story</span><span class="p">.</span><span class="nx">kids</span> <span class="p">?</span> <span class="s2">`
            &lt;span
              onclick="fetchOrToggleComments('</span><span class="p">${</span><span class="nx">story</span><span class="p">.</span><span class="nx">kids</span><span class="p">}</span><span class="s2">','</span><span class="p">${</span><span class="nx">story</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="s2">')"
              class='comments'
            &gt; [toggle </span><span class="p">${</span><span class="nx">story</span><span class="p">.</span><span class="nx">descendants</span><span class="p">}</span><span class="s2"> comments] &lt;/span&gt;`</span>
          <span class="p">:</span> <span class="s1">''</span> <span class="p">}</span><span class="s2">
          &lt;a href='</span><span class="p">${</span><span class="nx">storyItemUrl</span><span class="p">}</span><span class="s2">' target='_blank' class='hnLink'&gt;[view on HN]&lt;/a&gt;
        &lt;/div&gt;
        </span><span class="p">${</span><span class="nx">story</span><span class="p">.</span><span class="nx">text</span> <span class="p">?</span>
          <span class="s2">`&lt;div class='storyText' id='storyText-</span><span class="p">${</span><span class="nx">story</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="s2">' style='display:none;'&gt;
            </span><span class="p">${</span><span class="nx">story</span><span class="p">.</span><span class="nx">text</span><span class="p">}</span><span class="s2"> &lt;/div&gt;`</span> <span class="p">:</span> <span class="s1">''</span> <span class="p">}</span><span class="s2">
        &lt;div id='comments-</span><span class="p">${</span><span class="nx">story</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="s2">' style='display: block;'&gt;&lt;/div&gt;
      &lt;/div&gt; `</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">'hn'</span><span class="p">).</span><span class="nx">insertAdjacentHTML</span><span class="p">(</span><span class="s1">'beforeend'</span><span class="p">,</span> <span class="nx">html</span><span class="p">)</span>
  <span class="p">})</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nx">toggleStoryText</span><span class="p">(</span><span class="nx">storyId</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">storyText</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">`storyText-</span><span class="p">${</span><span class="nx">storyId</span><span class="p">}</span><span class="s2">`</span><span class="p">)</span>
  <span class="nx">storyText</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">=</span> <span class="p">(</span><span class="nx">storyText</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">===</span> <span class="s1">'block'</span><span class="p">)</span> <span class="p">?</span> <span class="s1">'none'</span> <span class="p">:</span> <span class="s1">'block'</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nx">fetchComments</span><span class="p">(</span><span class="nx">kids</span><span class="p">,</span> <span class="nx">storyId</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">commentIds</span> <span class="o">=</span> <span class="nx">kids</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">','</span><span class="p">)</span>
  <span class="kd">const</span> <span class="nx">allComments</span> <span class="o">=</span> <span class="nx">commentIds</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">commentId</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">commentUrl</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">hnBaseUrl</span><span class="p">}</span><span class="s2">/item/</span><span class="p">${</span><span class="nx">commentId</span><span class="p">}</span><span class="s2">.json`</span>
    <span class="k">return</span> <span class="nx">fetch</span><span class="p">(</span><span class="nx">commentUrl</span><span class="p">).</span><span class="nx">then</span><span class="p">((</span><span class="nx">response</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">()).</span><span class="nx">then</span><span class="p">((</span><span class="nx">comment</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">comment</span><span class="p">)</span>
  <span class="p">})</span>
  <span class="k">return</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">all</span><span class="p">(</span><span class="nx">allComments</span><span class="p">).</span><span class="nx">then</span><span class="p">((</span><span class="nx">comments</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">state</span><span class="p">[</span><span class="nx">storyId</span><span class="p">]</span> <span class="o">=</span> <span class="nx">comments</span>
    <span class="nx">renderComments</span><span class="p">(</span><span class="nx">comments</span><span class="p">,</span> <span class="nx">storyId</span><span class="p">)</span>
  <span class="p">})</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nx">fetchOrToggleComments</span><span class="p">(</span><span class="nx">kids</span><span class="p">,</span> <span class="nx">storyId</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">function</span> <span class="nx">toggleAllComments</span><span class="p">(</span><span class="nx">storyId</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">allComments</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">`comments-</span><span class="p">${</span><span class="nx">storyId</span><span class="p">}</span><span class="s2">`</span><span class="p">)</span>
    <span class="nx">allComments</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">=</span> <span class="p">(</span><span class="nx">allComments</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">===</span> <span class="s1">'block'</span><span class="p">)</span> <span class="p">?</span> <span class="s1">'none'</span> <span class="p">:</span> <span class="s1">'block'</span>
  <span class="p">}</span>
  <span class="nx">state</span><span class="p">[</span><span class="nx">storyId</span><span class="p">]</span> <span class="p">?</span> <span class="nx">toggleAllComments</span><span class="p">(</span><span class="nx">storyId</span><span class="p">)</span> <span class="p">:</span> <span class="nx">fetchComments</span><span class="p">(</span><span class="nx">kids</span><span class="p">,</span> <span class="nx">storyId</span><span class="p">)</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nx">toggleComment</span><span class="p">(</span><span class="nx">commentId</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">comment</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="nx">commentId</span><span class="p">)</span>
  <span class="kd">const</span> <span class="nx">toggle</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">`toggle-</span><span class="p">${</span><span class="nx">commentId</span><span class="p">}</span><span class="s2">`</span><span class="p">)</span>
  <span class="nx">comment</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">=</span> <span class="p">(</span><span class="nx">comment</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span> <span class="o">===</span> <span class="s1">'block'</span><span class="p">)</span> <span class="p">?</span> <span class="s1">'none'</span> <span class="p">:</span> <span class="s1">'block'</span>
  <span class="nx">toggle</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="p">(</span><span class="nx">toggle</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">===</span> <span class="s1">'[ - ]'</span><span class="p">)</span> <span class="p">?</span> <span class="s1">'[ + ]'</span> <span class="p">:</span> <span class="s1">'[ - ]'</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nx">renderComments</span><span class="p">(</span><span class="nx">comments</span><span class="p">,</span> <span class="nx">storyId</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">comments</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">comment</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">userUrl</span> <span class="o">=</span> <span class="s2">`https://news.ycombinator.com/user?id=</span><span class="p">${</span><span class="nx">comment</span><span class="p">.</span><span class="nx">by</span><span class="p">}</span><span class="s2">`</span>
    <span class="kd">const</span> <span class="nx">html</span> <span class="o">=</span> <span class="nx">comment</span><span class="p">.</span><span class="nx">deleted</span> <span class="o">||</span> <span class="nx">comment</span><span class="p">.</span><span class="nx">dead</span> <span class="p">?</span> <span class="s1">''</span> <span class="p">:</span> <span class="s2">`
      &lt;div class='comment'&gt;
        &lt;span
          onclick='toggleComment("</span><span class="p">${</span><span class="nx">comment</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="s2">")'
          href='javascript:void(0)'
          id='toggle-</span><span class="p">${</span><span class="nx">comment</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="s2">'
          class='toggle-comment'
        &gt;[ - ]&lt;/span&gt;
        &lt;a href='</span><span class="p">${</span><span class="nx">userUrl</span><span class="p">}</span><span class="s2">' class='comment-by'&gt; </span><span class="p">${</span><span class="nx">comment</span><span class="p">.</span><span class="nx">by</span><span class="p">}</span><span class="s2">&lt;/a&gt;
        &lt;div id=</span><span class="p">${</span><span class="nx">comment</span><span class="p">.</span><span class="nx">id</span><span class="p">}</span><span class="s2"> class='comment-text' style='display:block;'&gt;
          </span><span class="p">${</span><span class="nx">comment</span><span class="p">.</span><span class="nx">text</span><span class="p">}</span><span class="s2">
        &lt;/div&gt;
      &lt;/div&gt; `</span>
    <span class="nx">comment</span><span class="p">.</span><span class="nx">parent</span> <span class="o">==</span> <span class="nx">storyId</span> <span class="p">?</span>
      <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">`comments-</span><span class="p">${</span><span class="nx">storyId</span><span class="p">}</span><span class="s2">`</span><span class="p">).</span><span class="nx">insertAdjacentHTML</span><span class="p">(</span><span class="s1">'beforeend'</span><span class="p">,</span> <span class="nx">html</span><span class="p">)</span>
      <span class="p">:</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="nx">comment</span><span class="p">.</span><span class="nx">parent</span><span class="p">).</span><span class="nx">insertAdjacentHTML</span><span class="p">(</span><span class="s1">'beforeend'</span><span class="p">,</span> <span class="nx">html</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">comment</span><span class="p">.</span><span class="nx">kids</span><span class="p">)</span> <span class="k">return</span> <span class="nx">fetchComments</span><span class="p">(</span><span class="nx">comment</span><span class="p">.</span><span class="nx">kids</span><span class="p">.</span><span class="nx">toString</span><span class="p">(),</span> <span class="nx">storyId</span><span class="p">)</span>
  <span class="p">})</span>
<span class="p">}</span>
<span class="nx">fetchTopStories</span><span class="p">()</span>
</code></pre></div> <p>There you have it. Maybe someone else will also find a reason to use <a href="https://elliotec.com/hn-no-reason/">A Hacker News Reader For No Reason</a>.</p> <p><em>Update 2018-03-04</em>: This post has been translated into Russian at <a href="http://clipartmag.com/ru-a-hacker-news-reader-for-no-reason">clipartmag.com</a></p> </article> </main> <p class=copyright>&copy; Elliotec Software LLC</p> <p class=rss><a href="/feed.xml">RSS</a></p> <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Organization",
      "url": "https://elliotec.com",
      "name": "Elliotec Software LLC",
      "contactPoint": {
        "@type": "ContactPoint",
        "email": "me@elliotec.com",
        "contactType": "Email"
      },
      "sameAs": [
        "https://www.linkedin.com/in/elliotec",
        "https://twitter.com/elliotecweb"
      ]
    }
    </script> <script>
      if(navigator.userAgent.indexOf("Speed Insights") == -1) {
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-46276194-3', 'elliotec.com');ga('send', 'pageview');}
    </script> <script src="//instant.page/1.0.0" type=module integrity="sha384-6w2SekMzCkuMQ9sEbq0cLviD/yR2HfA/+ekmKiBnFlsoSvb/VmQFSi/umVShadQI"></script> </body> </html>